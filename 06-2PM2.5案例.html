<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<style type="text/css">
			body{
				margin:0;
				padding: 0;
				overflow: hidden;
			}
		</style>
		<script src="http://www.yanhuangxueyuan.com/versions/threejsR92/build/three.js"></script>
		<script src="http://www.yanhuangxueyuan.com/threejs/examples/js/controls/OrbitControls.js"></script>
	</head>
	<body>
		<script type="text/javascript">
			var scene=new THREE.Scene()
			var texture=new THREE.TextureLoader().load('./photo/4.jpg')
			// 创建组对象，包含所有精灵对象
			let group=new THREE.Group()
			// 文件加载对象
			var loader=new THREE.FileLoader().setResponseType('json')
			//加载数据
			loader.load('./数据.json',function(data){
				//遍历数据
				 data.forEach(elem => {
					 var spriteMaterial =new THREE.spriteMaterial({
					 	  map: texture, //设置精灵纹理贴图
					 	  transparent: true,
					 	  opacity: 0.5,
					 });
					 // 创建 精灵模型对象
					 var sprite=new THREE.sprite(spriteMaterial)
					 group.add(sprite);
					 // 控制精灵大小   使用PM2.5大小设置精灵模型的大小
					     // 注意适当缩放pm2.5大小,以便得到更好的显示效果
					     var k = elem.value / 200
					     sprite.scale.set(k, k, 1);
					     //获得城市坐标设置精灵模型对象的位置
					     sprite.position.set(elem.coordinate[0], elem.coordinate[1], 0)
				 })	
			   // 中国城市坐标整体的几何中心不在坐标原点，需要适当的平移
			   group.position.set(-110, -30, 0);
			   scene.add(group);//把精灵群组插入场景中
			})
			
			//光源设置
			var point=new THREE.PointLight(0xffffff);
			point.position.set(400,200,300);//光源位置
			scene.add(point);//将光源添加到场景中去
			
			//环境光  依次还有 点光源 平行光 
			var ambient=new THREE.AmbientLight(0x444444);
			scene.add(ambient);
			
			//相机设置
			//正投影相机
			var width=window.innerWidth;
			var height=window.innerHeight
			var k=width/height
			var s=150 //三维场景显示控制范围系数
			
			//创建相机对象
			var camera=new THREE.OrthographicCamera(-s * k, s * k, s, -s, 1, 1000);
			camera.position.set(200,300,200);//设置相机位置
			camera.lookAt(scene.position);//定义相机的位置与方向 即指向的场景对象
			
			
			//创建渲染器对象
			var renderer =new THREE.WebGLRenderer();
			renderer.setSize(width,height);//设置渲染区域尺寸
			renderer.setClearColor(0xb9d3ff,1);//设置背景颜色
			document.body.appendChild(renderer.domElement);//body元素中插入canvas对象
			//执行渲染操作  指定场景 相机作为参数
			// renderer.render(scene, camera);
			
			//鼠标操作
			function render() {
			  renderer.render(scene,camera);//执行渲染操作
			}
			render();
			var controls = new THREE.OrbitControls(camera,renderer.domElement);//创建控件对象
			controls.addEventListener('change', render);//监听鼠标、键盘事件
		</script>
	</body>
</html>
